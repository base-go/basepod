import{a as $,_ as D}from"./2AAiZstO.js";import{_ as E}from"./CtyriNnI.js";import{e as j,k as B,l as p,c as U,o as _,a as s,b as t,w as o,i as a,j as N,d as n,m as F,f as S,p as g,t as k}from"./BLG7DAKw.js";import{_ as A,u as L}from"./Bn6BUJbn.js";import{_ as T}from"./BWZzbGRp.js";import{_ as W}from"./HJyVqVik.js";import"./CTAlE1ge.js";import"./BwgwORTN.js";import"./BGXJoGEM.js";const I={class:"max-w-3xl space-y-6"},M={class:"space-y-4"},O={class:"space-y-4"},Q={class:"flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-800"},Z={class:"text-right"},q={key:0,class:"text-xs text-red-500 mt-1"},z={class:"flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-800"},G={class:"flex items-center justify-between py-2"},H={class:"space-y-4"},J={class:"flex items-center justify-between"},K={class:"flex items-center justify-between"},de=j({__name:"settings",async setup(X){let c,x;const{data:f}=([c,x]=B(()=>L("/health")),c=await c,x(),c),d=p({domain:"",email:"",enableWildcard:!0}),l=p({currentPassword:"",newPassword:"",confirmPassword:""}),i=p(""),v=p(!1),b=p(!1),h=async()=>{if(i.value="",v.value=!1,l.value.newPassword!==l.value.confirmPassword){i.value="Passwords do not match";return}if(l.value.newPassword.length<8){i.value="Password must be at least 8 characters";return}b.value=!0;try{await $fetch("/api/auth/change-password",{method:"POST",body:{currentPassword:l.value.currentPassword,newPassword:l.value.newPassword}}),v.value=!0,l.value={currentPassword:"",newPassword:"",confirmPassword:""}}catch(V){const e=V;i.value=e.data?.error||"Failed to change password"}finally{b.value=!1}};return(V,e)=>{const m=D,u=$,R=E,w=N,y=A,C=T,P=W;return _(),U("div",null,[s("div",I,[t(y,null,{header:o(()=>[...e[6]||(e[6]=[s("h3",{class:"font-semibold"},"Domain Settings",-1)])]),default:o(()=>[s("div",M,[t(u,{label:"Root Domain",help:"The main domain for your deployer instance"},{default:o(()=>[t(m,{modelValue:a(d).domain,"onUpdate:modelValue":e[0]||(e[0]=r=>a(d).domain=r),placeholder:"deployer.example.com"},null,8,["modelValue"])]),_:1}),t(u,{label:"Email",help:"Used for Let's Encrypt SSL certificates"},{default:o(()=>[t(m,{modelValue:a(d).email,"onUpdate:modelValue":e[1]||(e[1]=r=>a(d).email=r),type:"email",placeholder:"admin@example.com"},null,8,["modelValue"])]),_:1}),t(u,null,{default:o(()=>[t(R,{modelValue:a(d).enableWildcard,"onUpdate:modelValue":e[2]||(e[2]=r=>a(d).enableWildcard=r),label:"Enable wildcard subdomains"},null,8,["modelValue"])]),_:1}),t(w,null,{default:o(()=>[...e[7]||(e[7]=[n("Save Domain Settings",-1)])]),_:1})])]),_:1}),t(y,null,{header:o(()=>[...e[8]||(e[8]=[s("h3",{class:"font-semibold"},"Change Password",-1)])]),default:o(()=>[s("form",{class:"space-y-4",onSubmit:F(h,["prevent"])},[t(u,{label:"Current Password"},{default:o(()=>[t(m,{modelValue:a(l).currentPassword,"onUpdate:modelValue":e[3]||(e[3]=r=>a(l).currentPassword=r),type:"password",placeholder:"Enter current password"},null,8,["modelValue"])]),_:1}),t(u,{label:"New Password"},{default:o(()=>[t(m,{modelValue:a(l).newPassword,"onUpdate:modelValue":e[4]||(e[4]=r=>a(l).newPassword=r),type:"password",placeholder:"Enter new password"},null,8,["modelValue"])]),_:1}),t(u,{label:"Confirm New Password"},{default:o(()=>[t(m,{modelValue:a(l).confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=r=>a(l).confirmPassword=r),type:"password",placeholder:"Confirm new password"},null,8,["modelValue"])]),_:1}),a(i)?(_(),S(C,{key:0,color:"error",variant:"soft",title:a(i)},null,8,["title"])):g("",!0),a(v)?(_(),S(C,{key:1,color:"success",variant:"soft",title:"Password changed successfully"})):g("",!0),t(w,{type:"submit",loading:a(b)},{default:o(()=>[...e[9]||(e[9]=[n(" Change Password ",-1)])]),_:1},8,["loading"])],32)]),_:1}),t(y,null,{header:o(()=>[...e[10]||(e[10]=[s("h3",{class:"font-semibold"},"System Status",-1)])]),default:o(()=>[s("div",O,[s("div",Q,[e[11]||(e[11]=s("div",null,[s("p",{class:"font-medium"},"Podman"),s("p",{class:"text-sm text-gray-500"},"Container runtime")],-1)),s("div",Z,[t(P,{color:a(f)?.podman==="connected"?"success":"error"},{default:o(()=>[n(k(a(f)?.podman==="connected"?"Connected":"Disconnected"),1)]),_:1},8,["color"]),a(f)?.podman!=="connected"?(_(),U("p",q,k(a(f)?.podman_error),1)):g("",!0)])]),s("div",z,[e[13]||(e[13]=s("div",null,[s("p",{class:"font-medium"},"Caddy"),s("p",{class:"text-sm text-gray-500"},"Reverse proxy")],-1)),t(P,{color:"success"},{default:o(()=>[...e[12]||(e[12]=[n("Running",-1)])]),_:1})]),s("div",G,[e[15]||(e[15]=s("div",null,[s("p",{class:"font-medium"},"Database"),s("p",{class:"text-sm text-gray-500"},"SQLite")],-1)),t(P,{color:"success"},{default:o(()=>[...e[14]||(e[14]=[n("Connected",-1)])]),_:1})])])]),_:1}),t(y,{class:"border-red-200 dark:border-red-900"},{header:o(()=>[...e[16]||(e[16]=[s("h3",{class:"font-semibold text-red-600"},"Danger Zone",-1)])]),default:o(()=>[s("div",H,[s("div",J,[e[18]||(e[18]=s("div",null,[s("p",{class:"font-medium"},"Reset Configuration"),s("p",{class:"text-sm text-gray-500"},"Reset all settings to defaults")],-1)),t(w,{color:"error",variant:"soft"},{default:o(()=>[...e[17]||(e[17]=[n("Reset",-1)])]),_:1})]),s("div",K,[e[20]||(e[20]=s("div",null,[s("p",{class:"font-medium"},"Prune Unused Resources"),s("p",{class:"text-sm text-gray-500"},"Remove unused containers, images, and volumes")],-1)),t(w,{color:"error",variant:"soft"},{default:o(()=>[...e[19]||(e[19]=[n("Prune",-1)])]),_:1})])])]),_:1})])])}}});export{de as default};
